<!DOCTYPE html>
<html>
<head>
  <title>Update All Records</title>
</head>
<body>

  <h2>DAVT - Update All Records</h2>

  <label for="tableSelect">Select Table:</label>
  <select id="tableSelect">
    <option value="users">users</option>
    <option value="permissions">permissions</option>
    <option value="ranks">ranks</option>
  </select><br><br>

  <label for="columnName">Column to update:</label>
  <input type="text" id="columnName" placeholder="e.g. rank_id"><br><br>

  <label for="newValue">New Value:</label>
  <input type="text" id="newValue" placeholder="e.g. 1"><br><br>

  <button id="updateAllBtn">Update All</button>

  <pre id="output">Waiting for input...</pre>

  <script type="text/javascript" src="app/config/DatabaseConfig.js"></script>
  <script type="text/javascript" src="app/tpl/services/Database.js"></script>
  <script type="text/javascript" src="app/tpl/models/UserModel.js"></script>

  <script type="text/javascript">
  var db = new Database("database");
  var output = document.getElementById("output");

  document.getElementById("updateAllBtn").onclick = function() {
    var table = trim(document.getElementById("tableSelect").value);
    var column = trim(document.getElementById("columnName").value);
    var newValueRaw = trim(document.getElementById("newValue").value);

    if (!table || !column) {
      output.innerText = "Please select a table and enter a column name.";
      return;
    }

    // Try to parse newValue as number if possible
    var newValue = isNaN(newValueRaw) ? newValueRaw : Number(newValueRaw);
    var data = {};
    data[column] = newValue;
    // Correct usage: pass an object with key-value pairs
    var updatedCount = db.updateAll(table, data);

    output.innerText = updatedCount > 0
      ? "Updated " + updatedCount + " record(s) in table '" + table + "'."
      : "No records updated in table '" + table + "'.";
  };

  function trim(str) {
    return str.replace(/^\s+|\s+$/g, '');
  }
</script>


</body>
</html>
