<!DOCTYPE html>
<html>
   <head>
      <title>Login</title>
   </head>
   <body>
      <h2>Login</h2>
      <label for="username">Username:</label><br />
      <input type="text" id="username" name="username" /><br />
      <label for="password">Password:</label><br />
      <input type="password" id="password" name="password" /><br /><br />
      <button onclick="handleLoginClick()">Login</button>
      <div id="loginMessage"></div>
      <!-- Move script to the end of body -->
      <script type="text/javascript">
         function trim(str) {
           return str.replace(/^\s+|\s+$/g, '');
         }

         function handleLoginClick() {
           var username = trim(document.getElementById("username").value);
           var password = document.getElementById("password").value;
           var user = Models.User.validateCredentials(username, password);

         if (user) {
           window.session = {
           isLoggedIn: true,
           user: user
           };

           //window.execScript('MsgBox "Login successful!", 64, "Success"', 'VBScript');
           Loaders.Page.load("dashboard");
         } else {
           window.execScript('MsgBox "Invalid username or password.", 48, "Login Failed"', 'VBScript');
         }

         }
      </script>
   </body>
</html>
